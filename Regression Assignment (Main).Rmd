---
title: "MAT3024 Regression Analysis Assignment"
author: "Darren Yap Yee Shern"
date: "`r Sys.Date()`"
output:
  rmdformats::readthedown
---
## Group 1

Darren Yap Yee Shern (21001235) <br> Nur' Aliah Syamimi Binti Muhammad Sazali (21081765)<br> Chong Kai Yuan (21081609) <br> Ethan Lee Jia Hua (21089750) <br> Daniel Chin Wei Jian (20095204) <br> Harreesh Dev Chandrasager (20083200)

<br>

**INTRODUCTION**

Wine quality assessment is an important factor in the wine industry and the ability to predict the quality based on various chemical properties can enhance decision making processes in viticulture. In fact, chemical analysis of wine has been a well-established method for determining its quality; factors its acidity, sugar content and alcohol levels has been known to affect taste and overall consumer satisfaction.

#### DATA PROCESSING

```{r message=FALSE, warning=FALSE}

library(dplyr)
library(MASS)
library(ggplot2)
library(tidyverse)
library(olsrr)
library(AICcmodavg)
library(leaps)
library(corrplot)
library(car)
library(pastecs)
library(rmdformats)

```

```{r}
getwd()
Dataset<-read.csv("winequality-white.csv", sep =";")
glimpse(Dataset)
```

#### Dataset Description: Name

The dataset provided is considered for *vinho verde*, a unique product from Minho from the northwest region in Portugal and was collected from May (2004) to February (2007). Note that both red and white wine datasets were available, but the white wine dataset was chosen for analysis and the red wine dataset was used to validate and verify results

Variables Involved under considered dataset:

1.  Sulphates (g(potassium sulphate)/dm^3^)
2.  Chlorides (g(sodium chloride)/dm^3^)
3.  Volatile acidity (g(acetic acid)/dm^3^)
4.  Fixed acidity (g(tartaric acid)/dm^3^)
5.  Total sulfur dioxide (mg/dm^3^)
6.  Free sulfur dioxide (mg/dm^3^)
7.  Residual sugar (g/dm^3^)
8.  Citric acid (g/dm^3^)
9.  Density (g/cm^3^)
10. Alcohol (vol.%)
11. pH level
12. Quality

This Dataset consists of 4898 observations based on 12 variables

Data source: [Wine Quality Dataset](https://www.semanticscholar.org/paper/Modeling-wine-preferences-by-data-mining-from-Cortez-Cerdeira/bf15a0ccc14ac1deb5cea570c870389c16be019c)

**FINDING DESCRIPTIVE STATISTICS**

```{r}
#To display the structure of chosen dataset.
str(Dataset)

<<<<<<< HEAD
#To display descriptive statistics of chosen dataset.
round(stat.desc(Dataset),2)
=======
ggplot(Dataset, aes(x = quality)) + 
  geom_bar() + 
  xlab("Wine Quality") + 
  ylab("Frequency") + 
  ggtitle("Distribution of Wine Quality")

>>>>>>> 31f569634892c2d5d5ffd2fda5eaef2f58a3819e
```

**FITTING THE FULL MODEL**

```{r}

# Full model fitting

fullmodel<-lm(quality~.,data=Dataset)
summary(fullmodel)

# Initial preliminary values

fullmodel_aic <- AIC(fullmodel)
fullmodel_bic <- BIC(fullmodel)

fullmodel_aic
fullmodel_bic

```

#### **INTERPRETATION**

1)  Residual inspection : Residuals of the full model do appear to be symmetrically distributed around 0, which is ideal

2)  Coefficient inspection : by looking at the associated p-values for the t-test, we can identify whether the coefficient is significantly different zero. In this context, 3 variables stand out with having a p-value \>0.05, that being Citric Acid, Chlorides and Total Sulfur Dioxide.

3)  Residual standard error: value should be as minimal as possible to indicate a better model fitted; under the full model it is 0.7514

4)  Multiple R-squared: value should be as high as possible to indicate how well the model performs in explaining variability of the data observations; under the full model it is 0.2819

**INVESTIGATING INFLUENCE**

```{r}

#studentized residuals ( >3 may be potential outlier)

studentized_residuals_fullmodel<-studres(fullmodel)
plot(studentized_residuals_fullmodel)
residual_threshold=3

# cooks distance (points>1 considered influential)

cd_fullmodel<-cooks.distance(fullmodel)
plot(cd_fullmodel, main="Cook's distance visualization", ylab="cooks distance")
abline(h = 4/(nrow(Dataset)-length(coef(fullmodel))), col = "red")
cd_threshold=4/nrow(Dataset)


# hat values, to investigate leverage

hatvalues_fullmodel<-hatvalues(fullmodel)
plot(hatvalues_fullmodel)
abline(h= 2 * (length(fullmodel$coefficients)) / nrow(Dataset),col ="red")
leverage_threshold=2*(length(fullmodel$coefficients)) / nrow(Dataset)



#all flagged points that need to be removed

high_studentized_residual_points<-which(studentized_residuals_fullmodel>residual_threshold)
high_leverage_points<-which(hatvalues_fullmodel>leverage_threshold)

high_cooks_distance_points<-which(cd_fullmodel>cd_threshold)

all_potential_issues=unique(c(high_studentized_residual_points,high_leverage_points,high_cooks_distance_points))

updated_fullmodel<-Dataset[-all_potential_issues, ]

updated_fullmodel

```

**FITTING THE FULL MODEL**

```{r}
str(updated_fullmodel)
round(stat.desc(updated_fullmodel),2)

glm_updated_full = glm(quality ~., data= updated_fullmodel)

glm_updated_full

```
